# Монстарис (ТЗ)

## 1. Общая информация

1.1. **Название игры:** Монстарис  
1.2. **Тип игры:** Файтинговая арена с перемещениями по карте и экономической системой  
1.3. **Жанр:** PvP/PvE, тактическая стратегия  
1.4. **Целевая платформа:** Web (браузеры: Google Chrome, Yandex Browser, Mozilla Firefox)

### 1.5. Технологический стек

1.5.1. **Frontend:** React TypeScript, PixiJS  
1.5.2. **Backend:** PHP (серверная логика и API)  
1.5.3. **База данных:** MySQL

---

## 2. Цели и задачи

2.1. **Цель:** создать веб-игру с элементами мультиплеера и системы рынка, используя React TS, PHP, PixiJS.
2.2. **Задача:** разработка игры с поддержкой мультиплеера, торгового рынка и системы прогрессии персонажей. Осуществить сдачу проекта преподавателю (Трусову А.С.).

---

## 3. Игровая карта

3.1. **Размер карты:** 160x90 клеток (работаем с расширением 16:9)  
3.2. **Типы клеток:**

3.2.1. **Главный город:** 12х12 клеток (центр карты)  
3.2.2. **Chill-зоны:** размер различается, 5 зон всегда находятся в одних местах на карте. Площадь каждой не должна превышать 32 клеток. Их расположение на рассмотрение дизайнера.
3.2.3. **Данжи:** AхB клеток, каждая зона имеет уровень сложности. Тут присутствуют боты, которых надо убивать и получать с них ресурсы.
3.2.3.1. Чем дальше данж от **главного города**, тем сильнее в них боты (урон, защита выше).
3.2.4. **Нейтральные зоны** все остальные места карты. На них нет ботов, но если игроки там встретятся, пвп все равно начнется :)

### 3.3. Биомы стихий

3.3.1. **Лес (Земля):** 25% карты  
3.3.2. **Водоем (Вода):** 20% карты  
3.3.3. **Пустыня (Огонь):** 15% карты  
3.3.4. **Горы (Воздух):** 15% карты  
3.3.5. **Скорость перемещения:** 1 клетка за 0.3 секунды. Нельзя перемещаться по диагонали.
3.3.6. **Область видимости:** 5x5 клеток вокруг игрока

---

## 4. Система стихий

4.1. **Количество покемонов одной стихии:** 3  
4.2. **Количество стихий:** 4 (Огонь, Вода, Земля, Воздух)
4.3. **Всего различных покемонов:** 12.

### 4.3. Влияние биомов

4.3.1. **Лес (Земля):** +10% урона для земляных покемонов.
4.3.2. **Водоем (Вода):** +10% урона для водных покемонов.  
4.3.3. **Пустыня (Огонь):** +10% урона для огненных покемонов.  
4.3.4. **Горы (Воздух):** +10% урона для воздушных покемонов.

---

## 5. Боевая система

5.1. **Количество покемонов в отряде:** 3 (могут быть одинаковые) 
5.2. **Порядок ходов:** зависит от уровня покемонов. Ходы чередуются от самого высокого уровня к низкому. Если уровни равны, первый ход распределяется случайным образом.

### 5.3. Система боя

5.3.1. **Действия:** За один ход игрок может выбрать одно из трех действий: использовать скилл покемона (скилл) или убежать (побег).  
5.3.2. **Вероятность побега:** 10% шанс успешного побега за ход. В случае неудачи теряется 1 очко действия и ход переходит противнику.
5.3.3. **Время выбора действия:** У игрока есть 30 секунд, чтобы выбрать действие. В противном случае ход передается противнику.

### 5.4. Скиллы покемонов

5.4.1. **Количество скиллов:** 1 скилл у каждого покемона

### 5.5. Список покемонов с описанием скилла

5.5.1. **Лес (Земля):**

5.5.1.1. _Гриб_. Скилл - Тектонический удар: Вызывает мощный сдвиг земли, который бьет по одной цели с силой 150% от урона в статистике. Шанс вызвать оглушение (10%) из-за потрясения земли.
Оглушение блокирует следующий ход противника, т.е. игрок ходит дважды за раз.
Статистика (для первого уровня):
Урон: 150
Здоровье: 500
Защита: 60

5.5.1.2. _Пчела_. Скилл - Земной импульс: Создает земной всплеск, который наносит урон всем врагам. Используется скилл на конкретного покемона, нанося ему на 125% от урона из статистики, а всем остальным наносится 100% урона из статистики.
Статистика (для первого уровня):
Урон: 90
Здоровье: 550
Защита: 65

5.5.1.3. _Червь_. Скилл - Гравитационная волна: Изменяет локальную гравитацию, увеличивая вес врагов, что наносит им 25% от урона каждую секунду на протяжении 5 секунд.
Статистика (для первого уровня):
Урон: 70
Здоровье: 520
Защита: 55

5.5.2. **Водоем (Вода):**

5.5.2.1. _Лягушка_. Скилл - Ледяной шквал: Водный покемон выпускает ледяные иглы в цель, нанося 100% урон из статистики с шансом 50% заморозить противника на 1 ход.
Если цель заморожена, противник пропускает ход и следующий удар этим же покемонов нанесет 200% урона.
Статистика (для первого уровня):
Урон: 100
Здоровье: 450
Защита: 40

5.5.2.2. _Мотылёк_. Скилл - Каскад: Мощный водяной поток обрушивается на цель. Если цель - покемон стихии воздуха или огня, наносится 150% от урона из статистики.
Статистика (для первого уровня):
Урон: 110
Здоровье: 460
Защита: 45

5.5.2.3. _Рыба капля_. Скилл - Волна разрушения: Сильная водная атака, которая наносит 120% урона цели и 50% от этого урона всем ближайшим противникам.
Если цель была убита с 1 удара, ближайшие враги получают полный урон (ибо нефиг тут).
Статистика (для первого уровня):
Урон: 120
Здоровье: 500
Защита: 55

5.5.3. **Пустыня (Огонь):**

5.5.3.1. _Митбой_. Скилл - Испепеляющий удар: Мощная огненная атака, которая наносит 140% урона и вызывает статус "горение", наносящий урон в 10% от урона каждую секунду на протяжении 5 секунд.
Статистика (для первого уровня):
Урон: 140
Здоровье: 510
Защита: 45

5.5.3.2. _Ящерица_. Скилл - Огненная буря: Поднимает огненную бурю, наносящую 120% урона по всем врагам в зоне.
Статистика (для первого уровня):
Урон: 120
Здоровье: 530
Защита: 60

5.5.3.3. _Эмобой_. Скилл - Пепельный взрыв: Атакует с мощным взрывом огня, нанося 150% урона по одной цели и заставляя покемона гореть на протяжении 1 минуты.
Если враг уже имеет эффект "горения", урон составляет 200%.
Статистика (для первого уровня):
Урон: 150
Здоровье: 550
Защита: 65

5.5.4. **Горы (Воздух):**

5.5.4.1. _Медведь_. Скилл - Штормовой порыв: Атакует врага мощной воздушной атакой, нанося 110% урона, с дополнительным уроном (до +30%) на водяных покемонов.
Статистика (для первого уровня):
Урон: 110
Здоровье: 460
Защита: 45

5.5.4.2. _Слон_. Скилл - Воздушный клинок: Выпускает острую волну воздуха, наносящую 110% урона первому покемону противника, 120% урона второму и 130% уроня третьему.
Статистика (для первого уровня):
Урон: 120
Здоровье: 490
Защита: 55

5.5.4.3. _Кот_. Скилл - Циклон разрушения: Создает мощный воздушный вихрь, нанося 150% урона цели.
Статистика (для первого уровня):
Урон: 150
Здоровье: 520
Защита: 60

### 5.5.5. Победа в бою:

5.5.5.1. Победитель получает 30% монет, 10% покемонов (забираются имеющиеся куски яиц покемонов или понижаются уровни самих покемонов) и 20% кристаллов проигравшего.

---

# 6. Экономическая система

## 6.1. Валюта

6.1.1. В игре "Монстарис" основная валюта — **монеты**, которые используются для покупок на рынке и у торговца.  
6.1.2. Игрок начинает игру с 500 монет. Монеты и кристаллы можно зарабатывать через победы в боях и уничтожение ботов в данжах.
Игроки могут покупать покемонов на рынке, у торговца или обменивать куски яиц на целое яйцо у обменника.

## 6.2. Рынок

6.2.1. Рынок находится в главном городе и предоставляет игрокам возможность торговать покемонами, ресурсами и предметами.

6.2.2. Залог за выставление товара: 5% от установленной цены. Если товар был продан, залог возвращается продавцу. Если товар снят с продажи или не был продан, залог не возвращается.

6.2.3. Игроки могут выставлять на продажу различные предметы, но есть ограничения:

6.2.3.1. Игрок не может продавать покемонов, если у него в инвентаре осталось только 3 покемона. Это предотвращает ситуацию, когда игрок остается без покемонов для участия в боях.

6.2.4. Механика лотов и ставок: Каждый лот на рынке имеет фиксированное время, равное 5 минутам, и игроки могут делать ставки на товары. Лоты работают по принципу аукциона, как на eBay: игроки могут повышать ставки, и товар будет продан тому, кто предложит наибольшую цену в конце времени лота.

6.2.5. Ограничения на количество лотов: Чтобы предотвратить злоупотребления, игроки обязаны оставлять залог для выставления лота. Это ограничивает возможность бесконечно создавать новые лоты и ставить ставки на них.

6.2.6. Цены на ресурсы контролируются с учетом спроса и предложения, что требует расчетов, которые будут реализованы позже.

## 6.3. Торговец

6.3.1. **Торговец** - это отдельный персонаж на рынке (и отдельный экран), к которому игрок может обратиться для продажи определенных ресурсов. Игроки могут продавать Торговцу только яйца, куски яиц и кристаллы, но не самих покемонов.

6.3.2. **Статичные цены**. Цены на все ресурсы, которые Торговец принимает, фиксированы и не подвержены инфляции. 

## 6.4. Обменник

6.4.1. Обменник позволяет игрокам обменивать куски яиц на целые яйца покемонов. В обменнике установлены фиксированные условия:

6.4.1.1. Для получения одного яйца нужно обменять **50 кусков яиц**.

6.4.2. Это позволяет игрокам собирать куски яиц в различных активностях и использовать их для получения новых покемонов.

## 6.5. Инвентарь

6.5.1. Экран "Инвентарь" предоставляет игроку доступ ко всем имеющимся покемонам, позволяет улучшать их, просматривать статистику и выбирать трех покемонов, которые будут участвовать в сражениях.

6.5.2. Все покемоны, находящиеся во владении игрока, отображаются в инвентаре.

6.5.3. 3 покемона, которые участвуют в сражениях, находятся сверху (Команда для боя). Все остальные покемоны снизу (Покемоны не в команде).

- **Просмотр покемонов**: Игрок может видеть всех имеющихся покемонов.
- **Выбор покемонов для боя**: Игрок может выбрать трех покемонов, которые будут участвовать в сражениях.
- **Улучшение покемонов**: Игрок может повысить уровень покемонов с помощью полученных ресурсов.
- **Просмотр статистики**: Игрок может изучить полные статистические данные каждого покемона, чтобы лучше понять его сильные и слабые стороны.

---

# 7. Прокачка покемонов

## 7.1. Основные ресурсы

7.1.1. **Кристаллы:** Основной ресурс для прокачки покемонов. Они добываются в данжах или покупаются на рынке.  
7.1.2. **Улучшение:** как в Clash Royale, требуется определённое количество карт и кристаллов. Улучшение происходит с использованием кристаллов.

## 7.2. Стоимость улучшения

7.2.1. **1→2 уровень:** 10 кристаллов  
7.2.2. **2→3 уровень:** 20 кристаллов  
7.2.3. **3→4 уровень:** 100 кристаллов  
7.2.4. **4→5 уровень:** 500 кристаллов

## 7.3. Прокачка на уровнях

7.3.1. **1 уровень** - у покемона есть урон, здоровье и защита (по умолчанию).  
7.3.2. **2 уровень** - +30% к урону, здоровью и +20% к защите покемона (относительно 1 уровня)
7.3.2. **3 уровень** - +30% к урону, здоровью и +20% к защите покемона (относительно 2 уровня)
7.3.2. **4 уровень** - +30% к урону, здоровью и +20% к защите покемона (относительно 3 уровня)
7.3.2. **5 уровень** - +30% к урону, здоровью и +20% к защите покемона (относительно 4 уровня)

---

# 8. Лор и тематическое оформление

## 8.1. Мир

8.1.1. Фэнтезийный, где каждый биом представляет определенную стихию, а главные битвы происходят за контроль над этими территориями.

## 8.2. Персонажи

8.2.1. Покемоны уникальны по внешнему виду и способностям, каждый обладает характерными чертами своей стихии (огонь, вода, земля, воздух).

---

# 9. Дополнительные системы и механики

## 9.1. Стартовый набор

9.1.1. 500 монет  
9.1.2. 3 любых покемона 1 уровня

## 9.2. Внутриигровой чат

9.2.1. **Общий функционал чата**  
9.2.1.1. Внутриигровой чат находится на главной странице и доступен всем игрокам.  
9.2.1.2. Игроки могут отправлять сообщения, которые будут видны всем в реальном времени.  
9.2.1.3. Каждое сообщение содержит:

**_Никнейм отправителя._**
**_Время отправления (в формате Ч:M)._**
**_Текст сообщения._**

9.2.2. **Ограничения на сообщения**  
9.2.2.1. Минимальная длина сообщения: **1 символ**.  
9.2.2.2. Максимальная длина сообщения: **256 символов**.
9.3.2.3. Сообщения, превышающие ограничение по длине, не отправляются, а игроку показывается сообщение об ошибке ("Лимит символов в сообщении: 256").

9.2.3. **Управление и действия**  
9.2.3.1. Ввод текста осуществляется через текстовое поле в чате.  
9.2.3.2. Кнопка "Отправить" отправляет введенное сообщение. Если текстовое поле пустое, кнопка заблокирована.  
9.2.3.3. Сообщение также отправляется при нажатии "Enter".

---

# 10. Описание экранов игры

## 10.1. Экран регистрации/входа

10.1.1. Форма регистрации / входа: поля для ввода никнейма, логина и пароля.

### 10.1.2. Кнопки:

10.1.2.1. "Войти" (для существующих пользователей). Вводим логим и пароль.
10.1.2.2. "У меня нет аккаунта" (для существующих пользователей). Нереносит на форму регистрации.

10.1.2.3. "Зарегистрироваться" - вводим никнейм, логин и пароль для регистрации.
10.1.2.4. "У меня уже есть аккаунт" - возвращает на форму входа.

### 10.1.3. Валидация пароля:

10.1.3.1. Пароль может содержать заглавные и строчные буквы латинского алфавита, числа и специальные символы. Подсказки о сложности пароля не отображаются. Минимальная длина - 8 символов. Максимальная - до 15 символов.

### 10.1.4. Обработка ошибок:

10.1.4.1. Сообщения об ошибках при неправильном вводе данных (например, "Неверный пароль").

---

## 10.2. Экран меню

### 10.2.1. Основные кнопки:

10.2.1.1. "Карта" — открывает экран с картой.  
10.2.1.2. "Инвентарь" — открывает экран к ресурсам и покемонам игрока.  
10.2.1.3. "Рынок" — открывает экран для торговли покемонами и ресурсами.
10.2.1.5. "Крестик (выход из аккаунта, логаут)" - при нажатии пользователь выходит из своего аккаунта.

### 10.2.2. Статистика игрока:

10.2.2.1. Никнейм игрока + текущие ресурсы: Монеты, Кристаллы, яйца и куски яиц.

### 10.2.3. Внутриигровой чат

10.2.3.1. Чат отображается в правой нижней части экрана (при нажатии на кнопку).
10.2.3.2. Отображает список последних сообщений от игроков с их никнеймами, временем отправления и текстом сообщения.
10.2.3.3. Под списком сообщений находится текстовое поле для ввода сообщений и кнопка "Отправить".

---

## 10.3. Экран с игровой картой

### 10.3.1. Карта:

10.3.1.1. Прямоугольная сетка 160x90 клеток, занимает 80% экрана.  
10.3.1.2. Область видимости игрока: 5x5 клеток вокруг персонажа.

10.3.2. Аватар игрока отображается на клетке его местоположения.

### 10.3.3. Кнопки передвижения:

10.3.3.1. Вверх, вниз, влево, вправо — четыре стрелки для перемещения по карте. Перемещение на 1 клетку занимает 0.3 секунды.

---

# 10.4 Экран "Боевка"

## 10.4.1. Общая информация

Экран "Боевка" отображает ход сражения между покемонами игрока и его противника. Игрок управляет тремя покемонами, выбирая действия в течение каждого хода.

### 10.4.2. Элементы интерфейса

10.4.2.1. **Панель покемонов игрока**  
В верхней части экрана отображаются три покемона игрока. Каждый из покемонов имеет следующую информацию (имя по умолчанию), при нажатии/клике на покемона открывается его статистика:

- Здоровье (hp)
- Атака (atk)
- Защита (def)
- Уровень (lvl)

Чтобы скрить статистику, нужно еще раз нажать/кликнуть на покемона.

10.4.2.2. **Панель противника**  
Аналогичная панель для покемонов противника, показывающая ту же информацию.

10.4.2.3. **Поле боя**   
В центральной части экрана находится область боя, где отображаются покемоны игрока и противника в активной фазе сражения.

### 10.4.3. Кнопки и их действия

Пользователь может мышкой выбрать одного из своих покемонов во время боя. При нажатии на конкретного покемона он подсвечивается (это показывает выбранного на данный момент покемона).
На этого выбранного покемона и будут действовать функционал кнопок, описанных ниже.

10.4.3.1. **Кнопка "Скилл"**

- При нажатии открывается меню с доступными скиллами.
- После выбора скилла пользователь выбирает покемона противника, которого атакует, далее ход переходит к противнику.

10.4.3.2. **Кнопка "Атака"**

- Позволяет атаковать покемонов противника, нанеся им урон (который написан в статистике покемона).
- После нажатия здоровье покемонов противника уменьшается, и ход переходит к противнику.

10.4.3.3. **Кнопка "Отступить"**

- Позволяет попытаться сбежать с поля боя. Вероятность успешного побега — 10%.
- В случае успеха игрок покидает бой, теряя 5% монет и 5% кристаллов. В случае неудачи теряется возможность атаковать и ход переходит противнику.

### 10.4.4. Дополнительные элементы

10.4.4.1. **Индикатор хода**

- Отображает, чей ход текущий: игрока или противника.

---

## 10.5. Экран с рынком

### 10.5.1. Кнопки:

10.5.1.1. Лоты (открытые, закрытые, отмененные) — выбор, какую категорию лотов хочет увидеть пользователь. Если в данной категории нет лотов, снизу текст "Похоже на рынке нет активных лотов...".
10.5.1.2. "Создать лот" - при нажатии пользователь создает лот. Открывается панель с выбором лота (покемона), начальной ценой и шагом ставки (минимум, на сколько больше нужно предложить цену). В конце "Выставить" (выставляет лот), "Отменить"(отменяет выставку лота).
Если у пользователя не более 3х покемонов, то он не может выставить лот (выдаст ошибку).
10.5.1.2. "Купить" — приобретение товаров с рынка.  
10.5.1.3. "Статистика лота" — показывает информацию о текущем товаре (название товара, количество, продавец, начальная цена, шаг, текущая цена, купил (кто купил лот)).
10.5.1.4. "?" - в правом верхнем углу, при нажатии открывается окно с информацией о рынке:
"Рынок
Находится в главном городе, позволяет торговать покемонами, ресурсами и предметами. Залог: 5% от цены. Возвращается при продаже, удерживается при снятии или истечении срока. Ограничения: нельзя продавать покемонов, если в инвентаре осталось меньше 3. Лоты: фиксированы на 5 минут, работают по принципу аукциона. Лимит лотов: залог обязателен для ограничения их количества. Контроль цен: минимальные и максимальные цены на товары. Цены на ресурсы: зависят от спроса и предложения, расчеты в разработке"

---

## 10.6. Экран с торговцем

10.6.1. Торговец: вы можете продать ему яйца, куски яиц или кристаллы.

### 10.6.2. Кнопки:

10.6.2.1. "Продать" - продать товар торговцу. Если ресурсов недостаточно, на кнопке пишется "Недостаточно ресурсов".
Если ресурсов достаточно, при нажатии открывается окно "Продажа ресурсов: (название ресурса)", вводится количество ресурсов для продажи и кнопки "Подтвердить продажу"(продажа совершается) и "Отмена"(продажа отменяется).
10.6.2.2. "?" (в правом верхнем углу) - показывает информацию о торговце:
"Торговец
Торговец — это персонаж, который позволяет вам продавать ресурсы, такие как кристаллы, яйца и скорлупу, за монеты.". Снизу кнопка "Закрыть".

---

## 10.7. Экран с обменником

10.7.1. Обменник: позволяет обменивать куски яиц на яйца покемонов (50 кусков = 1 яйцо).

10.7.2. Добрая картинка обменника.
10.7.3. Кнопка "Обменять на яйцо" - при нажатии пользователь получает +1 яйцо и теряет 50 кусков яйца.
Открывает окно:
"Подтверждение обмена
Вы уверены, что хотите обменять 50 кусков яиц на одно яйцо?"
Кнопки: Да, Нет, Закрыть.
10.7.4. Кнопка "Получить покемона" - пользователь теряет 1 яйцо и получает случайного покемона. Открывается окно:
"Поздравляем
Вы получили покемона
(название)
Уровень: (число)
Стихия: (стихия)
Здоровье: (число)
Атака: (число)
Защита: (число)".
Снизу кнопка "Закрыть" - закрывает окно.

10.7.3.1. При присутствии необходимого количества кусков яиц происходит обмен. Игрок получает яицо покемона (из которого может выпасть случайный покемон).
10.7.3.2. При отсутствии необходимого количества кусков яиц: картинка обменника становится злой и появляется текст "Пошел отсюда, бомж. Приходи, когда соберешь необходимое количество кусков яиц!".
Кнопки становятся недоступными.

10.7.3.3. В правом верхнем углу кнопка "?" - при нажатии открывается информация об обменнике:
"Обменник
Позволяет обменивать 50 кусков яиц на одно яйцо покемона. Куски яиц можно собирать в активностях для получения новых покемонов". 
Снизу кнопка "Закрыть".

---

## 10.8. Экран "Инвентарь"

### 10.8.1. Список покемонов

- Экран разделен на 2 части: верхняя и нижняя.
- В нижней части инвентаря отображается список всех покемонов, принадлежащих игроку.
- Каждый покемон отображается с основными характеристиками: имя, уровень, стихия, здоровье, атака, защита.
- В верхней части находятся 3 покемоны, уже выбранные для боя.

### 10.8.2. Кнопки и их действия

10.8.2.1. **"Улучшить"**

- Доступна при выборе покемона в списке.
- Открывает меню подтверждения улучшения, где игрок может использовать доступные ресурсы для повышения уровня покемона.
- **Результат**: После подтверждения улучшений статистика покемона обновляется, и ресурсы игрока расходуются. Если ресурсов недостаточно, выводится сообщение "Недостаточно ресурсов, бомж!".

10.8.2.2. **"Заменить"**

- Доступна на иконках покемонов, не выбранных для боя.
- **При нажатии** у покемонов в "Команде для боя" появляются кнопки "Заменить".
- При выборе любого их них, старый покемон заменяется.
